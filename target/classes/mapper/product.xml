<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.kitri.bigdataShop.product">
	<select id="hitproduct" resultType="product">
		<![CDATA[select p.*, sort_table.sumqt from TB_PRODUCT p, (
			select prd_no, sum(qty) sumqt from TB_ORDER_PRODUCT group by prd_no order by sumqt desc) sort_table
			where p.prd_no = sort_table.prd_no and rownum<=4]]>	
	</select>
	<select id="newproduct" resultType="product">
		<![CDATA[select * from (
			select TB_PRODUCT.*, rank() over(order by REG_DTM desc) as myrank from TB_PRODUCT) rank_table 
			where rownum <= 3]]>
	</select>
	<select id="listall" resultType="product">
		select * from TB_PRODUCT  
	</select>
	<select id="categorySearch" parameterType="String" resultType="product">
		select * from tb_product where category_no = #{category}
	<!--select * from TB_PRODUCT  
		where CATEGORY_NO = (select CATEGORY_NO from TB_CATEGORY where
			CATEGORY_NM = #{category_nm})-->
	</select>
	<select id="read" parameterType="String" resultType="product">
		select * from tb_product where prd_no=#{prd_no}
	</select>
</mapper>